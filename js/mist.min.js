!function(e){"use strict";function t(e){return t.Statement.create(e)}e.requestAnimationFrame||function(){var t=e;t.requestAnimationFrame=t.mozRequestAnimationFrame||t.msRequestAnimationFrame||t.webkitRequestAnimationFrame}(),Element.prototype.matches||function(){var e=Element.prototype;e.matches=e.mozMatchesSelector||e.msMatchesSelector||e.webkitMatchesSelector}(),t.inherit=function(e,t){e.prototype=Object.create(t.prototype,{constructor:{value:e},_super:{value:t}})},t.module=function(e,n){t[e]=n()},e.Mist=t}(window,document);
;Mist.module("Creator",function(){"use strict";function n(n){var e=this;e.responses={},n.create=function(){var n=JSON.stringify(arguments);return e.responses[n]||(e.responses[n]=s(this,arguments)),e.responses[n]}}function s(n,s){return new(n.bind.apply(n,[n].concat([].slice.apply(s))))}return n});
;Mist.module("Classes",function(){"use strict";function t(t){this.statement=t}return t.prototype.add=function(t){this.statement.each(function(e){e.classList.add(t)})},t.prototype.remove=function(t){this.statement.each(function(e){e.classList.remove(t)})},t.prototype.toggle=function(t){this.statement.each(function(e){e.classList.toggle(t)})},new Mist.Creator(t),t});
;Mist.module("Matrix",function(){function t(t){this.value=new Mist.Value(function(){var r=getComputedStyle(t),n=(r.transform||r.mozTransform||r.msTransform||r.webkitTransform).match(/matrix\((.*?)\)/);return n?n[1].split(/\s?,\s?/).map(parseFloat):[1,0,0,1,0,0]}()),this.value.then(function(r){console.dir(r);var n=getComputedStyle(t),o=n.transform||n.mozTransform||n.msTransform||n.webkitTransform;o=[o.replace(/(matrix\(.*?\)|none)/,""),["matrix(",r.join(),")"].join("")].join(" "),t.style.transform=o,t.style.mozTransform=o,t.style.msTransform=o,t.style.webkitTransform=o})}function r(t,r){return null!=t?t:r}return t.prototype.add=function(t){this.value.compose(function(r){return[r[0]+(t[0]||0),r[1]+(t[1]||0),r[2]+(t[2]||0),r[3]+(t[3]||0),r[4]+(t[4]||0),r[5]+(t[5]||0)]})},t.prototype.get=function(){return this.value.composite},t.prototype.set=function(t){this.value.compose(function(n){return[r(t[0],n[0]),r(t[1],n[1]),r(t[2],n[2]),r(t[3],n[3]),r(t[4],n[4]),r(t[5],n[5])]})},t});
;Mist.module("Motion",function(){function t(t){this.statement=t}return t.prototype.point=function(t,n,i){var e=[];this.statement.each(function(i){var o=new Mist.Matrix(i),u=new Mist.Shape(i).distance(t,n),a=o.get();e.push(function(t){o.set([null,null,null,null,a[4]+u[0]*t,a[5]+u[1]*t])})}),i.then(function(t){e.forEach(function(n){n(t)})})},t.prototype.rotate=function(t,n){var i=[];this.statement.each(function(n){var e=new Mist.Matrix(n),o=e.get();i.push(function(n){e.set([o[0]+Math.cos(t)*n,o[1]+Math.sin(t)*n,o[2]-Math.sin(t)*n,o[3]+Math.cos(t)*n,null,null])})}),n.then(function(t){i.forEach(function(n){n(t)})})},t.prototype.translate=function(t,n,i){var e=[];this.statement.each(function(i){var o=new Mist.Matrix(i),u=o.get();e.push(function(i){o.set([null,null,null,null,u[4]+t*i,u[5]+n*i])})}),i.then(function(t){e.forEach(function(n){n(t)})})},t});
;Mist.module("Promise",function(){"use strict";function e(e){var r=this;r.resolver=function(e){r.resolver.statement?r.resolver.statement(e):r.resolver.completor=function(){r.resolver(e)}},r.rejector=e.rejector||function(e){r.rejector.statement?r.rejector.statement(e):r.rejector.completor=function(){r.rejector(e)}},e(r.resolver,r.rejector)}return e.prototype.catch=function(r){var t=this,o=function(e){o.resolver=e,o.rejector=e,t.rejector.completor&&t.rejector.completor()};return t.rejector.statement=function(e){try{var t=r(e);null!=t&&o.resolver(t)}catch(c){o.rejector(c)}},new e(o)},e.prototype.then=function(r,t){var o=this,c=function(e){c.resolver=e,o.resolver.completor&&o.resolver.completor()};return c.rejector=o.rejector,o.resolver.statement=function(e){try{var o=r(e);null!=o&&c.resolver(o)}catch(n){if(t){var o=t(n);null!=o&&c.resolver(o)}else c.rejector(n)}},new e(c)},e});
;Mist.module("Shape",function(){"use strict";function t(t){this.coords=function(){if(t instanceof Element){var n=t.getBoundingClientRect();return[[n.left,n.top],[n.right,n.top],[n.right,n.bottom],[n.left,n.bottom]]}return t}}function n(t,n,r){var o=new Mist.Vector(n[0],n[1]).initial(t[0],t[1]),e=new Mist.Vector(r[0],r[1]).initial(t[0],t[1]),i=o.cross(e);return i?i/Math.abs(i):1}return t.prototype.center=function(){var t=this.coords(),n=[0,0];return t.forEach(function(t){n[0]+=t[0],n[1]+=t[1]}),n[0]/=t.length,n[1]/=t.length,n},t.prototype.collision=function(t){for(var r,o=this.coords(),e=t.coords(),i=e.length;i--;)for(var c=o.length;c--;){var s=n(o[(c?c:o.length)-1],o[c],e[i]);if(r){if(r!=s)return!1}else r=s}return!0},t.prototype.distance=function(t,n){var r=this.center();return[t-r[0],n-r[1]]},t});
;Mist.module("Statement",function(){"use strict";function t(t){this.selector=t,this.classes=new Mist.Classes(this),this.motion=new Mist.Motion(this)}function n(t){return document.querySelectorAll(t)}return t.prototype.collision=function(t){return this.some(function(n){return new Mist.Shape(n).collision(t)})},t.prototype.combination=function(t){return new Mist.Combination(t.map(this.on.bind(this))).listen()},t.prototype.each=function(t){[].forEach.call(n(this.selector),t)},t.prototype.fast=function(t){return new Mist.Fast(t.map(this.on.bind(this))).listen()},t.prototype.map=function(t){return[].map.call(n(this.selector),t)},t.prototype.on=function(t){return Mist.Event.create(t,this.selector).listen()},t.prototype.sequence=function(t){return new Mist.Sequence(t.map(this.on.bind(this))).listen()},t.prototype.some=function(t){return[].some.call(n(this.selector),t)},new Mist.Creator(t),t});
;Mist.module("Stream",function(){"use strict";function t(){this.computes=[]}return t.prototype.add=function(t){this.computes.forEach(function(n){n(t)})},t.prototype.every=function(t){return this.listen().then(function(n){return t(n)?n:void 0})},t.prototype.listen=function(){return new Mist.Subscripter(this)},t});
;Mist.module("Transition",function(){"use strict";function t(n,e){var u=this,r=t[n];u.computer=function(t){u.add(r(t,0,1,e)),u.seek=t,u.paused||e>t&&requestAnimationFrame(u.computer.bind(u.computer,t+1))},u.seek=0,u._super.call(u)}return Mist.inherit(t,Mist.Stream),t.prototype.pause=function(){this.paused=!0},t.prototype.resume=function(){this.paused=!1,this.computer(this.seek)},t.prototype.start=function(){this.paused=!1,this.computer(1)},t.easeInBack=function(t,n,e,u){return e*(t/=u)*t*(2.70158*t-1.70158)+n},t.easeInBounce=function(n,e,u,r){return u-t.easeOutBounce(r-n,0,u,r)+e},t.easeInCirc=function(t,n,e,u){return-e*(Math.sqrt(1-(t/=u)*t)-1)+n},t.easeInCubic=function(t,n,e,u){return e*(t/=u)*t*t+n},t.easeInElastic=function(t,n,e,u){return 0==(t/=u)?n:1==t?n+e:-(e*Math.pow(2,10*--t)*Math.sin(6.283185307179586*(0>t*u-e?p/4:p/9.86960440108936)/p))+n},t.easeInExpo=function(t,n,e,u){return 0==t?n:e*Math.pow(2,10*(t/u-1))+n},t.easeInQuad=function(t,n,e,u){return e*(t/=u)*t+n},t.easeInQuart=function(t,n,e,u){return e*(t/=u)*t*t*t+n},t.easeInQuint=function(t,n,e,u){return e*(t/=u)*t*t*t*t+n},t.easeInSine=function(t,n,e,u){return-e*Math.cos(t/u*(Math.PI/2))+e+n},t.easeInOutBack=function(t,n,e,u){return(t/=u/2)<1?e/2*t*t*(3.5949095*t-2.5949095)+n:e/2*((t-=2)*t*(3.5949095*t+2.5949095)+2)+n},t.easeInOutBounce=function(n,e,u,r){return r/2>n?.5*t.easeInBounce(2*n,0,u,r)+e:.5*t.easeOutBounce(2*n-r,0,u,r)+.5*u+e},t.easeInOutCirc=function(t,n,e,u){return(t/=u/2)<1?-e/2*(Math.sqrt(1-t*t)-1)+n:e/2*(Math.sqrt(1-(t-=2)*t)+1)+n},t.easeInOutCubic=function(t,n,e,u){return(t/=u/2)<1?e/2*t*t*t+n:e/2*((t-=2)*t*t+2)+n},t.easeInOutElastic=function(t,n,e,u){return 0==(t/=u)?n:t/2==2?n+e:t--<1?-.5*e*Math.pow(2,10*t)*Math.sin(6.283185307179586*(0>t*u-e?.3*u*1.5/4:.3*u*1.5/9.86960440108936)/(.3*u*1.5))+n:e*Math.pow(2,-10*t)*Math.sin(6.283185307179586*(0>t*u-e?.3*u*1.5/4:.3*u*1.5/9.86960440108936)/(.3*u*1.5))*.5+e+n},t.easeInOutExpo=function(t,n,e,u){return 0==t?n:t==u?n+e:(t/=u/2)<1?e/2*Math.pow(2,10*(t-1))+n:e/2*(-Math.pow(2,-10*--t)+2)+n},t.easeInOutQuad=function(t,n,e,u){return(t/=u/2)<1?e/2*t*t+n:-e/2*(--t*(t-2)-1)+n},t.easeInOutQuart=function(t,n,e,u){return(t/=u/2)<1?e/2*t*t*t*t+n:-e/2*((t-=2)*t*t*t-2)+n},t.easeInOutQuint=function(t,n,e,u){return(t/=u/2)<1?e/2*t*t*t*t*t+n:e/2*((t-=2)*t*t*t*t+2)+n},t.easeInOutSine=function(t,n,e,u){return-e/2*(Math.cos(Math.PI*t/u)-1)+n},t.easeOutBack=function(t,n,e,u){return e*((t=t/u-1)*t*(2.70158*t+1.70158)+1)+n},t.easeOutBounce=function(t,n,e,u){return(t/=u)<1/2.75?7.5625*e*t*t+n:2/2.75>t?e*(7.5625*(t-=1.5/2.75)*t+.75)+n:2.5/2.75>t?e*(7.5625*(t-=2.25/2.75)*t+.9375)+n:e*(7.5625*(t-=2.625/2.75)*t+.984375)+n},t.easeOutCirc=function(t,n,e,u){return e*Math.sqrt(1-(t=t/u-1)*t)+n},t.easeOutCubic=function(t,n,e,u){return e*((t=t/u-1)*t*t+1)+n},t.easeOutElastic=function(t,n,e,u){return 0==(t/=u)?n:1==t?n+e:e*Math.pow(2,-10*t)*Math.sin(6.283185307179586*(t*u-(0>e?.3*u/4:.3*u/9.86960440108936))/(.3*u))+e+n},t.easeOutExpo=function(t,n,e,u){return t==u?n+e:e*(-Math.pow(2,-10*t/u)+1)+n},t.easeOutQuad=function(t,n,e,u){return-e*(t/=u)*(t-2)+n},t.easeOutQuart=function(t,n,e,u){return-e*((t=t/u-1)*t*t*t-1)+n},t.easeOutQuint=function(t,n,e,u){return e*((t=t/u-1)*t*t*t*t+1)+n},t.easeOutSine=function(t,n,e,u){return e*Math.sin(t/u*(Math.PI/2))+n},t.linear=function(t,n,e,u){return e*t/u+n},t});
;Mist.module("Vector",function(){"use strict";function t(t,i){this.x=t,this.y=i}return t.prototype.cross=function(t){return this.x*t.y-this.y*t.x},t.prototype.dot=function(t){return this.x*t.x+this.y*t.y},t.prototype.initial=function(i,r){return t.create(this.x-i,this.y-r)},new Mist.Creator(t),t});
;Mist.module("Combination",function(){"use strict";function t(t){function n(){if(i.computes.length){var r=t.length;return void t.map(function(t,n){t.then(function(t){e[n]=t,e.length==r&&(i.add(e),e=[])})})}requestAnimationFrame(n)}var i=this,e=[];i._super.call(i),n()}return Mist.inherit(t,Mist.Stream),t});
;Mist.module("Event",function(){"use strict";function t(t,e){var n=this;n._super.call(n),document.addEventListener(t,function(t){var i=t.target;i instanceof Element&&i.matches(e)&&n.add(t)})}return t.customize=function(t,e){var n=document.createEvent("CustomEvent");return e=e||{},n.initCustomEvent(t,e.bubbles||!0,e.cancelable||!0,e.detail),n},Mist.inherit(t,Mist.Stream),new Mist.Creator(t),t});
;Mist.module("Fast",function(){"use strict";function t(t){function n(){if(e.computes.length){var r,u=t.length;return void t.map(function(t,n){t.then(function(t){r==n&&(i=[]),i.length==u&&(i=[]),0==i.length&&(e.add(t),r=n),i[n]=t})})}requestAnimationFrame(n)}var e=this,i=[];e._super.call(e),n()}return Mist.inherit(t,Mist.Stream),t});
;Mist.module("Sequence",function(){"use strict";function e(e){function n(){if(t.computes.length){for(var r=e.length,i=[],s=[],a=r;a-->0;)i[a]=new Mist.Stream,s[a]=i[a].listen();for(var a=r;a-->1;){var o=function(e,n){return u.push(n),i[e-1].pause(),i[e].resume(),u};i[a-1].pause(),i[a-1].then(o.bind(o,a))}return i[r-1].pause(),i[r-1].then(function(e){u.push(e),i[r-1].pause(),i[0].resume(),t.add(u),u=[]}),e.map(function(e,n){e.then(s[n].add.bind(s[n]))}),void i[0].resume()}requestAnimationFrame(n)}var t=this,u=[];t._super.call(t),n()}return Mist.inherit(e,Mist.Stream),e});
;Mist.module("Subscripter",function(){"use strict";function t(t){var e=this;e.computes=t.computes,e._super.call(e,function(t,s){e.computes.push(e.compute=function(u){try{e.paused||t(u)}catch(i){s(i)}})})}return Mist.inherit(t,Mist.Promise),t.prototype.cancel=function(){var t=this.computes.indexOf(this.compute);t>-1&&this.computes.splice(t,1)},t.prototype.pause=function(){this.paused=!0},t.prototype.resume=function(){this.paused=!1},t});
;Mist.module("Value",function(){"use strict";function t(t){var o=this;o.composite=t,o._super.call(o,function(t,i){o.compute=function(){o.computed||(o.computed=!0,requestAnimationFrame(function(){try{t(o.composite)}catch(e){i(e)}finally{o.computed=!1}}))}})}return Mist.inherit(t,Mist.Promise),t.prototype.compose=function(t){this.composite=t(this.composite),this.compute()},t});
